!function e(t,n,o){function r(c,u){if(!n[c]){if(!t[c]){var a="function"==typeof require&&require;if(!u&&a)return a(c,!0);if(i)return i(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[c]={exports:{}};t[c][0].call(f.exports,function(e){var n=t[c][1][e];return r(n||e)},f,f.exports,e,t,n,o)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,t,n){"use strict";function o(e,t){chrome.tabs.sendMessage(t,{type:"config-init",config:e},function(){})}function r(e,t){function n(e,t){var n=e.substr(e.indexOf("#")+1),o=void 0,r=void 0;for(n=n.split("&"),o=0;o<n.length;o+=1)if((r=n[o].split("="))[0]===t)return r[1];return""}function r(e,t){alert(e+"\n"+t)}return function i(u,a){var s=void 0;if(u===e&&void 0!==a.url&&"loading"===a.status&&a.url.indexOf("oauth.vk.com/blank.html")>-1){if(e=null,chrome.tabs.onUpdated.removeListener(i),void 0===(s=n(a.url,"access_token"))||void 0===s.length)return void r("vk auth response problem","access_token length = 0 or vkAccessToken == undefined");c.vkToken=s,chrome.storage.local.set({vkaccess_token:s},function(){}),chrome.tabs.update(t,{active:!0}),o(c,t)}}}function i(e){var t="https://oauth.vk.com/authorize?client_id="+e.vk.clientId+"&scope="+e.vk.scope+"&redirect_uri=http%3A%2F%2Foauth.vk.com%2Fblank.html&display=page&response_type=token";chrome.tabs.query({active:!0,currentWindow:!0},function(n){var i=n[0];chrome.storage.local.get({vkaccess_token:{}},function(n){void 0===n.vkaccess_token.length?chrome.tabs.create({url:t,selected:!0},function(e){chrome.tabs.onUpdated.addListener(r(e.id,i.id))}):(e.vkToken=n.vkaccess_token,o(e,i.id))})})}var c=void 0;chrome.runtime.onMessage.addListener(function(e){if("init-config"===e.type){if(c)return void i(c);chrome.runtime.getPackageDirectoryEntry(function(e){e.getFile("config.json",{},function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(){i(c=JSON.parse(this.result))},t.readAsText(e)})})})}})},{}]},{},[1]);